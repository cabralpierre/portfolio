if (self.CavalryLogger) { CavalryLogger.start_js(["hX2Mx"]); }

__d("TimelineCollectionItemReorder",["csx","cx","AsyncRequest","DataStore","DOMQuery","OGCollectionAddObject","Parent","SortableGroup","TimelineAppCollection","$"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j="item-reorder-inst";function k(m,n){"use strict";this._collectionToken=n;this._initSorting();c("DataStore").set(c("$")(m),j,this);c("TimelineAppCollection").subscribe(c("TimelineAppCollection").NEW_ITEM,this._processNewItem.bind(this,m));c("OGCollectionAddObject").subscribe(c("OGCollectionAddObject").NEW_ITEM,this._processNewItem.bind(this,m))}k.prototype._initSorting=function(){"use strict";this._sortableGroup=new(c("SortableGroup"))().setDropCallback(function(m,n){new(c("AsyncRequest"))("/ajax/timeline/collections/reorder_items/").setData({order:this._sortableGroup.getOrder(),collection_token:this._collectionToken}).send()}.bind(this))};k.prototype._registerCollectionItems=function(m){"use strict";var n=c("DOMQuery").scry(m,"li[data-sort-id]");n.forEach(function(o){this._registerCollectionItem(o)},this)};k.prototype._registerCollectionItem=function(m){"use strict";var n=m.getAttribute("data-sort-id");this._sortableGroup.removeSortable(n);setTimeout(this._sortableGroup.addSortable.bind(this._sortableGroup,n,m),500)};k.prototype._processNewItem=function(m,n,o){"use strict";var p=c("Parent").bySelector(o.grid,"._30f");if(m!=p.id)return;this._registerCollectionItem(o.newItem)};k.registerCollectionItems=function(m,n,o){"use strict";var p=l(m,n);if(p)p._registerCollectionItems(o)};function l(m,n){var o=c("DataStore").get(c("$")(m),j);return o||new k(m,n)}f.exports=k}),null);
__d("TimelineInHouseOGCurationControl",["csx","CSS","DOM","Parent","ProfileTabUtils","TimelineAppCollection"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(j,k,l,m){__p&&__p();this._menu=j;this._collectionToken=k;this._popoverMenu=l;this._placeholderMarkup=m;this._menu.subscribe("itemclick",function(n,o){__p&&__p();var p=o.item.getValue(),q="add_to_top",r="remove_from_top";if(p=="delete"||p=="recommend")return;if(p==k){o.item.deselect();j.done();return}var s=c("Parent").bySelector(this._popoverMenu,"._3owb");if(p=="highlight"){var t=c("DOM").scry(s,"._54_4");if(t[0])if(!o.item.isSelected())c("CSS").addClass(t[0],"selected");else c("CSS").removeClass(t[0],"selected");j.done();return}else if(p&&p.substring(0,q.length)===q){c("TimelineAppCollection").addPlaceholderToCollection(p.substring(q.length+1),s.parentNode);j.done();return}else if(p&&p.substring(0,r.length)===r){var u=p.substring(r.length+1);if(k!==u){c("TimelineAppCollection").decrementCount(c("ProfileTabUtils").getIDForCollectionToken(u));j.done();return}}s.appendChild(m);c("CSS").hide(c("DOM").find(s,"[data-collection-item-bg]"));c("CSS").hide(c("DOM").find(s,"[data-collection-item-priv]"));if(!p){j.done();return}c("TimelineAppCollection").decrementCount(c("ProfileTabUtils").getIDForCollectionToken(k));if(p.substring(0,15)!=r)c("TimelineAppCollection").addPlaceholderToCollection(p,s.parentNode);j.done()}.bind(this))}f.exports=i}),null);